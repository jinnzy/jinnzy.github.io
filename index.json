[{"categories":["docker"],"content":"ä½¿ç”¨dockeræ–¹å¼ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶åœ¨åä¸ºäº‘é²²é¹ä¸Šè¿è¡Œç¼ºå°‘åº“ï¼Œæ‰€ä»¥é€‰æ‹©ç›´æ¥åœ¨é²²é¹è™šæœºä¸Šç¼–è¯‘ å®‰è£…python3 yum install git python36 python36-devel python36-pip zlib-devel -y python3 -m pip install --upgrade pip # æ›´æ–°pip å¼€å§‹ç¼–è¯‘ æ‹‰å–composeé¡¹ç›® git clone https://github.com/docker/compose.git åˆ›å»ºvenv ç¯å¢ƒ cd compose/ python3 -m venv venv source ./venv/bin/activate python setup.py develop å®‰è£…ä¾èµ– yum install libffi-devel å®‰è£…ä¸€äº›ä¾èµ–åº“ python setup.py develop pip install -r ./requirements-build.txt å¼€å§‹ç¼–è¯‘ pyinstaller -F ./docker-compose.spec ç›¸å…³é”™è¯¯è§£å†³ï¼š ","date":"2021-03-11","objectID":"/bian-yi-docker-compose-armban-ben/:0:0","tags":["docker"],"title":"ç¼–è¯‘docker-compose armç‰ˆæœ¬","uri":"/bian-yi-docker-compose-armban-ben/"},{"categories":["docker"],"content":"ModuleNotFoundError: No module named â€˜setuptools_rustâ€™ pip install --upgrade setuptools ","date":"2021-03-11","objectID":"/bian-yi-docker-compose-armban-ben/:1:0","tags":["docker"],"title":"ç¼–è¯‘docker-compose armç‰ˆæœ¬","uri":"/bian-yi-docker-compose-armban-ben/"},{"categories":["docker"],"content":"compose/GITSHA No such file or directory åˆ é™¤ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„, ä¹Ÿè¦åˆ é™¤ , ( 'compose/GITSHA', 'compose/GITSHA', 'DATA' ) å‚è€ƒèµ„æ–™ https://blog.csdn.net/qq_28808029/article/details/107221921 ","date":"2021-03-11","objectID":"/bian-yi-docker-compose-armban-ben/:2:0","tags":["docker"],"title":"ç¼–è¯‘docker-compose armç‰ˆæœ¬","uri":"/bian-yi-docker-compose-armban-ben/"},{"categories":["å‰ç«¯"],"content":"åœ¨åšnamespaceå…‹éš†çš„æ—¶å€™éœ€è¦ç”¨åˆ°ä¸¤ä¸ªä¸‹æ‹‰æ¡†é€‰æ‹©æºnamespaceå’Œç›®æ ‡namespace,ç”¨åˆ°äº†elementçš„el-selectç»„ä»¶ï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰é—®é¢˜ï¼Œä½¿ç”¨objectä½œä¸ºå€¼ï¼Œé€‰æ‹©ä¸‹æ‹‰æ¡†éƒ½ä¼šåªæ˜¾ç¤ºæœ€åä¸€ä¸ªæ•°æ®ã€‚ æ•°æ®å¦‚ä¸‹ï¼š ä»£ç å¦‚ä¸‹ï¼š \u003cel-select v-model=\"sourceCluster\" placeholder=\"æºé›†ç¾¤\"\u003e \u003cel-option v-for=\"item in clusterOptions\" :key=\"item.id\" :label=\"item.cluster + '/' + item.namespace\" :value=\"item\"\u003e \u003c/el-option\u003e \u003c/el-select\u003e \u003c/el-form-item\u003e \u003cel-form-item label=\"å…‹éš†åˆ°\"\u003e \u003cel-select v-model=\"targetCluster\" placeholder=\"ç›®æ ‡é›†ç¾¤\"\u003e \u003cel-option v-for=\"item in clusterOptions\" :key=\"item.id\" :label=\"item.cluster + '/' + item.namespace\" :value=\"item\"\u003e \u003c/el-option\u003e \u003c/el-select\u003e æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å‘ç°ï¼Œå¦‚æœä½¿ç”¨å¯¹è±¡ç±»å‹æ—¶ï¼Œè¦æ·»åŠ value-key ä½œä¸ºvalueçš„å”¯ä¸€æ ‡è¯†é”®åï¼Œä¿®æ”¹åå¦‚ä¸‹ï¼š \u003cel-select v-model=\"sourceCluster\" value-key=\"id\" placeholder=\"æºé›†ç¾¤\"\u003e \u003cel-option v-for=\"item in clusterOptions\" :key=\"item.id\" :label=\"item.cluster + '/' + item.namespace\" :value=\"item\"\u003e \u003c/el-option\u003e \u003c/el-select\u003e \u003c/el-form-item\u003e \u003cel-form-item label=\"å…‹éš†åˆ°\"\u003e \u003cel-select v-model=\"targetCluster\" value-key=\"id\" placeholder=\"ç›®æ ‡é›†ç¾¤\"\u003e \u003cel-option v-for=\"item in clusterOptions\" :key=\"item.id\" :label=\"item.cluster + '/' + item.namespace\" :value=\"item\"\u003e \u003c/el-option\u003e \u003c/el-select\u003e å¯ä»¥æ­£å¸¸é€‰æ‹©äº†ã€‚ ","date":"2021-02-17","objectID":"/el-selectshi-yong-objectzuo-wei-valuezhi/:0:0","tags":["element"],"title":"el-selectä½¿ç”¨objectä½œä¸ºvalueå€¼","uri":"/el-selectshi-yong-objectzuo-wei-valuezhi/"},{"categories":["kubernetes"],"content":"çº¿ä¸‹æµ‹è¯•ç¯å¢ƒå‡çº§k8sé›†ç¾¤è¿‡äº†å‡ å¤©åï¼Œç ”å‘åŒå­¦æŠ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œmyhuaweicloud.comåŸŸåæ— æ³•è®¿é—®ï¼Œä¹‹å‰æ˜¯å¯ä»¥çš„ã€‚ è¿›å…¥åˆ°æ‰€åœ¨podå†…ï¼Œping myhuaweicloud.comè¯•äº†ä¸‹æ— æ³•è§£æåŸŸåï¼Œå†ping baidu.com å’Œå…¶ä»–åŸŸåæ˜¯æ­£å¸¸çš„ï¼ŒçŒœæµ‹å¤§æ¦‚ç‡é—®é¢˜å‡ºåœ¨äº†corednsä¸Šï¼Œå…ˆæŠŠcoredns debugæ—¥è‡³æ‰“å¼€è§‚å¯Ÿä¸€ä¸‹ .:53 { ... log debug ... } åœ¨å®¹å™¨å†…pingmyhuaweicloud.com ï¼ŒæŸ¥çœ‹æ—¥å¿—å‘ç°searchåŸŸ å’Œç»å¯¹åŸŸåéƒ½è§£æä¸åˆ°ï¼Œè¿™å°±å¾ˆå¥‡æ€ªäº†ã€‚ ç„¶åæŸ¥çœ‹äº†ä¸€ä¸‹corednsé…ç½®ï¼Œå‘ç°äº†é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬k8så†…åº”ç”¨è®¿é—®å¤–ç½‘ç»Ÿä¸€éƒ½æ˜¯èµ°çš„egress,æœ‰ä¸€äº›sdkæ”¯æŒä»£ç†å°±ç›´æ¥ä½¿ç”¨äº†ï¼Œè¿˜æœ‰ä¸€äº›æ— æ³•ä½¿ç”¨ä»£ç†çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨corednsæŠŠåŸŸåè§£æåˆ°egressçš„åœ°å€ä¸Šï¼Œè¿™æ ·å°±ä¼šèµ°egressä»£ç†äº†ã€‚ é—®é¢˜å°±åœ¨äºä¸Šæ¬¡å‡çº§åæŠŠcorednsä¹Ÿæ›´æ–°äº†ï¼Œconfigmapæ·»åŠ çš„custom.dbæ–‡ä»¶å’ŒdeploymentæŒ‚è½½çš„é…ç½®éƒ½æ²¡äº†ï¼ŒéšåæŠŠè¿™ä¸ªæ·»åŠ ä¸Šæ¢å¤æ­£å¸¸äº†ã€‚ åé¢è¦æ³¨æ„å‡çº§k8såï¼Œè¿™äº›ç³»ç»Ÿç»„ä»¶çš„é…ç½®å˜åŒ–ï¼Œé¿å…è¸©å‘ã€‚ ","date":"2021-02-02","objectID":"/pai-cha-k8sji-qun-sheng-ji-hou-mou-ge-wai-wang-yu-ming-wu-fa-fang-wen/:0:0","tags":["é”™è¯¯æ€»ç»“","kubernetes"],"title":"æ’æŸ¥k8sé›†ç¾¤å‡çº§åæŸä¸ªå¤–ç½‘åŸŸåæ— æ³•è®¿é—®","uri":"/pai-cha-k8sji-qun-sheng-ji-hou-mou-ge-wai-wang-yu-ming-wu-fa-fang-wen/"},{"categories":["elasticsearch"],"content":"æ²¡ä½¿ç”¨dockerä¹‹å‰ï¼Œåœ¨å®‰è£…/å‡çº§esæ—¶å¤„ç†æ’ä»¶ç‰¹åˆ«éº»çƒ¦ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦å®‰è£…/å‡çº§å¯¹åº”æ’ä»¶ï¼Œä½¿ç”¨dockerååªéœ€è¦æŠŠéœ€è¦ç”¨åˆ°çš„æ’ä»¶é¢„å…ˆå®‰è£…åˆ°é•œåƒä¸­å°±å¯ä»¥äº†ã€‚ ","date":"2021-01-31","objectID":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/:0:0","tags":["docker","elasticsearch"],"title":"elasticsearch dockeré•œåƒæ·»åŠ æ’ä»¶","uri":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/"},{"categories":["elasticsearch"],"content":"Dockerfile åœ¨å®˜æ–¹æä¾›çš„é•œåƒåŸºç¡€ä¸Šåˆ©ç”¨å¤šé˜¶æ®µæ„å»ºæ·»åŠ äº†ik pinyin repository-s3 ç­‰æ’ä»¶ FROM alpine:3.9 as builder WORKDIR /opt RUN echo \"http://mirrors.aliyun.com/alpine/v3.9/main/\" \u003e /etc/apk/repositories \u0026\u0026 \\ echo \"http://mirrors.aliyun.com/alpine/v3.9/community/\" \u003e\u003e /etc/apk/repositories \u0026\u0026 \\ apk update \u0026\u0026 \\ apk upgrade \u0026\u0026 \\ apk add wget \u0026\u0026 \\ wget -O ik.zip https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.10.2/elasticsearch-analysis-ik-{{ES_VERSION}}.zip \u0026\u0026 \\ wget -O pinyin.zip https://github.com/medcl/elasticsearch-analysis-pinyin/releases/download/v7.10.2/elasticsearch-analysis-pinyin-{{ES_VERSION}}.zip \u0026\u0026 \\ wget -O repository-s3.zip https://artifacts.elastic.co/downloads/elasticsearch-plugins/repository-s3/repository-s3-v7.10.2.zip FROM docker.elastic.co/elasticsearch/elasticsearch:7.10.2 COPY --from=builder /opt/ik.zip /tmp/ COPY --from=builder /opt/pinyin.zip /tmp/ COPY --from=builder /opt/repository-s3.zip /tmp/ COPY ./bin/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh RUN bin/elasticsearch-plugin install -b file:///tmp/ik.zip \u0026\u0026\\ bin/elasticsearch-plugin install -b file:///tmp/pinyin.zip \u0026\u0026\\ bin/elasticsearch-plugin install -b file:///tmp/repository-s3.zip \u0026\u0026\\ rm -f /tmp/ik.zip \u0026\u0026\\ rm -f /tmp/pinyin.zip \u0026\u0026 \\ rm -f /tmp/repository-s3.zip \u0026\u0026 \\ chown 1000.1000 /usr/local/bin/docker-entrypoint.sh \u0026\u0026 \\ chmod 755 /usr/local/bin/docker-entrypoint.sh bin/docker-entrypoint.sh å…¥å£å¯åŠ¨æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶éšç€ç‰ˆæœ¬å‡çº§ä¼šæœ‰æ”¹åŠ¨ï¼Œåˆ¶ä½œé•œåƒå‰æœ€å¥½æŸ¥çœ‹ä¸€ä¸‹ç›®æ ‡ç‰ˆæœ¬çš„å…¥å£æ–‡ä»¶ã€‚ åœ¨å®˜æ–¹æä¾›çš„docker-entrypoint.shåŸºç¡€ä¸Šæ·»åŠ äº†ä¸€äº›æ’ä»¶ç›¸å…³çš„é…ç½®å˜é‡ã€‚ #!/bin/bash set -e # Files created by Elasticsearch should always be group writable too umask 0002 run_as_other_user_if_needed() { if [[ \"$(id -u)\" == \"0\" ]]; then # If running as root, drop to specified UID and run command exec chroot --userspec=1000 / \"${@}\" else # Either we are running in Openshift with random uid and are a member of the root group # or with a custom --user exec \"${@}\" fi } # Allow user specify custom CMD, maybe bin/elasticsearch itself # for example to directly specify `-E` style parameters for elasticsearch on k8s # or simply to run /bin/bash to check the image if [[ \"$1\" != \"eswrapper\" ]]; then if [[ \"$(id -u)\" == \"0\" \u0026\u0026 $(basename \"$1\") == \"elasticsearch\" ]]; then # centos:7 chroot doesn't have the `--skip-chdir` option and # changes our CWD. # Rewrite CMD args to replace $1 with `elasticsearch` explicitly, # so that we are backwards compatible with the docs # from the previous Elasticsearch versions\u003c6 # and configuration option D: # https://www.elastic.co/guide/en/elasticsearch/reference/5.6/docker.html#_d_override_the_image_8217_s_default_ulink_url_https_docs_docker_com_engine_reference_run_cmd_default_command_or_options_cmd_ulink # Without this, user could specify `elasticsearch -E x.y=z` but # `bin/elasticsearch -E x.y=z` would not work. set -- \"elasticsearch\" \"${@:2}\" # Use chroot to switch to UID 1000 exec chroot --userspec=1000 / \"$@\" else # User probably wants to run something else, like /bin/bash, with another uid forced (Openshift?) exec \"$@\" fi fi # Allow environment variables to be set by creating a file with the # contents, and setting an environment variable with the suffix _FILE to # point to it. This can be used to provide secrets to a container, without # the values being specified explicitly when running the container. # # This is also sourced in elasticsearch-env, and is only needed here # as well because we use ELASTIC_PASSWORD below. Sourcing this script # is idempotent. source /usr/share/elasticsearch/bin/elasticsearch-env-from-file if [[ -f bin/elasticsearch-users ]]; then # Check for the ELASTIC_PASSWORD environment variable to set the # bootstrap password for Security. # # This is only required for the first node in a cluster with Security # enabled, but we have no way of knowing which node we are yet. We'll just # honor the variable if it's present. if [[ -n \"$ELASTIC_PASSWORD\" ]]; then [[ -f /usr/share/elasticsearch/config/elasticsearch.keystore ]] || (run_as_other_user_if_needed elasticsearch-keystore create) ","date":"2021-01-31","objectID":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/:1:0","tags":["docker","elasticsearch"],"title":"elasticsearch dockeré•œåƒæ·»åŠ æ’ä»¶","uri":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/"},{"categories":["elasticsearch"],"content":"æ„å»ºé•œåƒ docker build -t elasticsearch:7.10.2-customize . è¿™æ ·åé¢å®‰è£…æˆ–è€…å‡çº§éƒ½ä¸éœ€è¦æ“å¿ƒæ’ä»¶ä¹‹ç±»çš„é—®é¢˜äº†ï¼Œç›´æ¥æ›¿æ¢é•œåƒå³å¯ã€‚ å¤‡æ³¨ï¼šä¸Šé¢è¿™äº›æ–‡ä»¶å·²ç»æ”¾åˆ°githubä¸Šäº†ï¼Œå¦‚æœæœ‰éœ€è¦ä¹Ÿå¯ä»¥ä»è¿™é‡Œæ‹‰å– ","date":"2021-01-31","objectID":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/:2:0","tags":["docker","elasticsearch"],"title":"elasticsearch dockeré•œåƒæ·»åŠ æ’ä»¶","uri":"/elasticsearch-dockerjing-xiang-tian-jia-cha-jian/"},{"categories":["docker"],"content":"æ„å»ºå¤šå¹³å°é•œåƒçš„å‡ ç§æ–¹æ³• ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:0:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"QEMUä»¿çœŸ ä½¿ç”¨qemu ä»¿çœŸå‡ºå¾ˆå¤šå¹³å°ï¼Œbuildxé›†æˆäº†è¯¥ç‰¹æ€§ï¼Œå¯ä»¥å®ç°åœ¨å…¶ä»–å¹³å°æ„å»ºä¸éœ€è¦ä¿®æ”¹dockerfile ï¼Œå½“å®ƒéœ€è¦å¯¹ä¸åŒçš„æ¶æ„è¿è¡Œä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šè‡ªå·±ä»binfmt_misc å¤„ç†å™¨ä¸­å·²ç»æ³¨å†Œçš„æ¶æ„å»åŠ è½½å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åœ¨binfmt_miscå¤„ç†å™¨é‡Œå»æ³¨å†Œæˆ‘ä»¬æƒ³è¦çš„æ¶æ„çš„ã€‚ æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»ä½¿ç”¨è¯¥æ–¹æ³•æ¥å®ç°å¤šå¹³å°é•œåƒæ„å»ºã€‚ ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:1:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"ä½¿ç”¨ä¸åŒèŠ‚ç‚¹æ¥æ„å»º è¿™ç§æ–¹å¼æ€§èƒ½è¾ƒå¥½ï¼Œä½†æ˜¯å¹¶æœªé€‰æ‹©è¿™ç§æ–¹å¼ï¼Œå¦‚æœæƒ³æ·±å…¥äº†è§£ï¼Œå¯ä»¥å‚è€ƒå…¶ä»–èµ„æ–™ã€‚ å®˜æ–¹ä¾‹å­ï¼š $ docker buildx create --use --name mybuild node-amd64 mybuild $ docker buildx create --append --name mybuild node-arm64 $ docker buildx build --platform linux/amd64,linux/arm64 . ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:2:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"äº¤å‰ç¼–è¯‘ å¦‚æœå¼€å‘è¯­è¨€å¯¹äº¤å‰ç¼–è¯‘æ”¯æŒè¾ƒå¥½ï¼Œå¯ä»¥ä½¿ç”¨dockerfilesçš„å¤šé˜¶æ®µæ„å»ºï¼Œå¯ä»¥æ„å»ºæ—¶ä¼ å…¥BUILDPLATFORM å’ŒTARGETPLATFORM å‚æ•°é€‰æ‹©è¿è¡Œçš„å¹³å°åŠç¼–è¯‘çš„å¹³å°ã€‚ FROM --platform=$BUILDPLATFORM golang:alpine AS build ARG TARGETPLATFORM ARG BUILDPLATFORM RUN echo \"I am running on $BUILDPLATFORM, building for $TARGETPLATFORM\" \u003e /log FROM alpine COPY --from=build /log /log ä½¿ç”¨buildxæ„å»º ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:3:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"å¼€å¯docker buildx å¼€å¯docker buildxæ’ä»¶ï¼Œè¦æ±‚ç‰ˆæœ¬ä¸ä½äº19.03 ç¬¬ä¸€ç§æ–¹æ³•ä¸´æ—¶å¼€å¯ï¼š $ export DOCKER_CLI_EXPERIMENTAL=enabled ç¬¬äºŒç§æ–¹æ³•ï¼šåœ¨config.json ä¸­å¼€å¯\"experimental\": \"enabled\" $ vim ~/.docker/config.json { ... \"experimental\": \"enabled\" } éªŒè¯ $ docker buildx version github.com/docker/buildx v0.3.1-tp-docker 6db68d029599c6710a32aa7adcba8e5a344795a7 ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:4:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"å¼€å¯binfmt_misc å¦‚æœä½¿ç”¨çš„æ˜¯docker desktopé»˜è®¤æ˜¯å·²ç»å¯ç”¨binfmt_miscçš„äº† å†…æ ¸ç‰ˆæœ¬æœ€å¥½å¤§äº3.xï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯5.xçš„å†…æ ¸ã€‚ è¿™é‡Œä½¿ç”¨[docker/binfmt](https://github.com/docker/binfmt) å¼€å¯ç‰¹æƒæ¨¡å¼å¯ç”¨binfmt_misc docker run --privileged --rm docker/binfmt:a7996909642ee92942dcd6cff44b9b95f08dad64 æ£€æŸ¥æ˜¯å¦å¼€å¯æˆåŠŸ $ ls -l /proc/sys/fs/binfmt_misc/ total 0 -rw-r--r--. 1 root root 0 Jan 7 17:41 jexec -rw-r--r--. 1 root root 0 Jan 7 17:43 qemu-aarch64 -rw-r--r--. 1 root root 0 Jan 7 17:43 qemu-arm -rw-r--r--. 1 root root 0 Jan 7 17:43 qemu-ppc64le -rw-r--r--. 1 root root 0 Jan 7 17:43 qemu-riscv64 -rw-r--r--. 1 root root 0 Jan 7 17:43 qemu-s390x --w-------. 1 root root 0 Jan 7 17:41 register -rw-r--r--. 1 root root 0 Jan 7 17:41 status æ£€æŸ¥æ˜¯å¦å¯ç”¨å¤„ç†å™¨ $ grep -r \"enabled\" /proc/sys/fs/binfmt_misc/ /proc/sys/fs/binfmt_misc/qemu-riscv64:enabled /proc/sys/fs/binfmt_misc/qemu-s390x:enabled /proc/sys/fs/binfmt_misc/qemu-ppc64le:enabled /proc/sys/fs/binfmt_misc/qemu-arm:enabled /proc/sys/fs/binfmt_misc/qemu-aarch64:enabled /proc/sys/fs/binfmt_misc/jexec:enabled grep: /proc/sys/fs/binfmt_misc/register: Invalid argument /proc/sys/fs/binfmt_misc/status:enabled ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:5:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"åˆ›å»ºbuilder éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„docker builderï¼Œåç§°å«builder $ docker buildx create --name builder --use builder $ docker buildx ls NAME/NODE DRIVER/ENDPOINT STATUS PLATFORMS builder docker-container builder0 unix:///var/run/docker.sock inactive default * docker default default running linux/amd64, linux/386 è¿™æ—¶å¯ä»¥çœ‹åˆ°ä¸€ä¸ªé»˜è®¤builderå’Œæˆ‘ä»¬æ–°å»ºçš„ä¸€ä¸ªbuilderï¼Œç›®å‰æ–°å»ºçš„builderè¿˜å¤„äºinactiveçš„çŠ¶æ€ã€‚ é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯åŠ¨æ–°çš„builderã€‚ $ docker buildx inspect builder --bootstrap [+] Building 63.8s (1/1) FINISHED =\u003e [internal] booting buildkit 63.8s =\u003e =\u003e pulling image moby/buildkit:buildx-stable-1 61.9s =\u003e =\u003e creating container buildx_buildkit_builder0 1.9s Name: builder Driver: docker-container Nodes: Name: builder0 Endpoint: unix:///var/run/docker.sock Status: running Platforms: linux/amd64, linux/arm64, linux/riscv64, linux/ppc64le, linux/s390x, linux/386, linux/arm/v7, linux/arm/v6 ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:6:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"æ„å»ºå¤šå¹³å°é•œåƒ å½“å‰ç›®å½•ç»“æ„ï¼š $ tree â”œâ”€â”€ Dockerfile â””â”€â”€ test.go Dockerfile: FROM golang:1.15-alpine AS builder WORKDIR /opt RUN go build -o test . FROM alpine WORKDIR /opt COPY --from=builder /opt/test . CMD [\"./test\"] test.go package main import ( \"fmt\" ) func main() { fmt.Println(\"test\") } å¼€å§‹æ„å»ºå¹¶ä¸Šä¼ ï¼Œæ³¨æ„harbor ç‰ˆæœ¬è¦åœ¨2.0 ä»¥ä¸Šæ‰æ”¯æŒã€‚ $ docker buildx build -t reg.xxxxxx.cn/app/test-golang:v1 --platform=linux/arm64,linux/amd64 --push . [+] Building 5.2s (22/22) FINISHED =\u003e [internal] load build definition from Dockerfile 0.0s =\u003e =\u003e transferring dockerfile: 92B 0.0s =\u003e [internal] load .dockerignore 0.0s =\u003e =\u003e transferring context: 2B 0.0s =\u003e [linux/amd64 internal] load metadata for docker.io/library/alpine:latest 2.3s =\u003e [linux/amd64 internal] load metadata for docker.io/library/golang:1.15-alpine 2.0s =\u003e [linux/arm64 internal] load metadata for docker.io/library/alpine:latest 3.1s =\u003e [linux/arm64 internal] load metadata for docker.io/library/golang:1.15-alpine 2.1s =\u003e [linux/amd64 builder 1/4] FROM docker.io/library/golang:1.15-alpine@sha256:49b4eac11640066bc72c74b70202478b7d431c7d8918e0973d6e4aeb8b3129d2 0.0s =\u003e =\u003e resolve docker.io/library/golang:1.15-alpine@sha256:49b4eac11640066bc72c74b70202478b7d431c7d8918e0973d6e4aeb8b3129d2 0.0s =\u003e [linux/arm64 stage-1 1/3] FROM docker.io/library/alpine@sha256:3c7497bf0c7af93428242d6176e8f7905f2201d8fc5861f45be7a346b5f23436 0.1s =\u003e =\u003e resolve docker.io/library/alpine@sha256:3c7497bf0c7af93428242d6176e8f7905f2201d8fc5861f45be7a346b5f23436 1.8s =\u003e [linux/arm64 builder 1/4] FROM docker.io/library/golang:1.15-alpine@sha256:49b4eac11640066bc72c74b70202478b7d431c7d8918e0973d6e4aeb8b3129d2 0.1s =\u003e =\u003e resolve docker.io/library/golang:1.15-alpine@sha256:49b4eac11640066bc72c74b70202478b7d431c7d8918e0973d6e4aeb8b3129d2 0.0s =\u003e [linux/amd64 stage-1 1/3] FROM docker.io/library/alpine@sha256:3c7497bf0c7af93428242d6176e8f7905f2201d8fc5861f45be7a346b5f23436 0.1s =\u003e =\u003e resolve docker.io/library/alpine@sha256:3c7497bf0c7af93428242d6176e8f7905f2201d8fc5861f45be7a346b5f23436 0.0s =\u003e [internal] load build context 0.0s =\u003e =\u003e transferring context: 178B 0.0s =\u003e CACHED [linux/amd64 stage-1 2/3] WORKDIR /opt 0.0s =\u003e CACHED [linux/amd64 builder 2/4] WORKDIR /opt 0.0s =\u003e CACHED [linux/amd64 builder 3/4] ADD . /opt/ 0.0s =\u003e CACHED [linux/amd64 builder 4/4] RUN go build -o test . 0.0s =\u003e CACHED [linux/amd64 stage-1 3/3] COPY --from=builder /opt/test . 0.0s =\u003e CACHED [linux/arm64 stage-1 2/3] WORKDIR /opt 0.0s =\u003e CACHED [linux/arm64 builder 2/4] WORKDIR /opt 0.0s =\u003e CACHED [linux/arm64 builder 3/4] ADD . /opt/ 0.0s =\u003e CACHED [linux/arm64 builder 4/4] RUN go build -o test . 0.0s =\u003e CACHED [linux/arm64 stage-1 3/3] COPY --from=builder /opt/test . 0.0s =\u003e exporting to image 1.8s =\u003e =\u003e exporting layers 0.6s =\u003e =\u003e exporting manifest sha256:714e4f18895bb698c65392eda3b39e35b38df0e84c34ce1f604bfa8fdb466a77 0.0s =\u003e =\u003e exporting config sha256:0339ab69edd09e4038046c8c056305733f050918725b6f265780189c0bdd76e3 0.0s =\u003e =\u003e exporting manifest sha256:a5c4695278c99a1801c557e68145d7a1e61fa82288a9d2b43b1f85219dea5b8a 0.0s =\u003e =\u003e exporting config sha256:a69d7dfa854e466d743d09c3c95ebca68f2feb6cb335bc0aecc4a256cc95e68f 0.0s =\u003e =\u003e exporting manifest list sha256:77677ebebf2dda103c6cd8598018a1d9bb79e06102173588fef5c501e81f6cb3 0.0s =\u003e =\u003e pushing layers 0.5s =\u003e =\u003e pushing manifest for reg.xxxxxx.cn/app/test-golang:v1 ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:7:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"å¼€æœºå¯åŠ¨ ç”±äºé‡å¯åbinfmt_misc å’Œbuilder éƒ½ä¼šåœæ­¢ï¼Œæ‰€ä»¥è¦è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚ binfmt_misc åŠ å…¥å¼€æœºå¯åŠ¨è„šæœ¬ cat \u003e /etc/rc.d/init.d/enable-binfmt.sh \u003c\u003c EOF #!/bin/bash docker run --privileged --rm docker/binfmt:a7996909642ee92942dcd6cff44b9b95f08dad64 EOF builder æ·»åŠ --restart=always BUILDER=$(docker ps | grep buildkitd | awk '{print $1}') docker update --restart=always $BUILDER é‡åˆ°çš„é”™è¯¯ ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:8:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"ä¸Šä¼ é•œåƒæ—¶x509: certificate signed by unknown authority å®Œæ•´æŠ¥é”™ï¼š failed to solve: rpc error: code = Unknown desc = failed to do request: Head [\u003chttps://reg.xxxxxx.cn/v2/app/test-golang/blobs/sha256:0c1f186a05c7a4d0cb23b4a339473c5e96115be11f4deb24f74d3f2324120c87:\u003e](\u003chttps://reg.xxxxxx.cn/v2/app/test-golang/blobs/sha256:0c1f186a05c7a4d0cb23b4a339473c5e96115be11f4deb24f74d3f2324120c87:\u003e) x509: certificate signed by unknown authority è¿™æ˜¯å› ä¸ºå…¬å¸æ‰€ç”¨çš„harborè¯ä¹¦æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œæš‚æ—¶çš„è§£å†³æ–¹æ³•æ˜¯å°†harborè¯ä¹¦åŠ åˆ°builderå®¹å™¨ä¸­ã€‚ $ BUILDER=$(docker ps | grep buildkitd | awk '{print $1}') $ docker cp ./harbor.crt $BUILDER:/usr/local/share/ca-certificates/ # harbor.crtä¸ºharbor caè¯ä¹¦ $ sudo docker exec $BUILDER update-ca-certificates $ sudo docker restart $BUILDER é‡æ–°ä¸Šä¼ é•œåƒå³å¯ã€‚ ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:9:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"docker: â€˜buildxâ€™ is not a docker command. å¼€å¯buildxåè¿˜æ˜¯æŠ¥è¿™ä¸ªé”™ï¼ŒæŸ¥çœ‹äº†ä¸‹å’Œä¹‹å‰æˆåŠŸå®‰è£…çš„ç¯å¢ƒä¿¡æ¯ æœ‰é—®é¢˜çš„ï¼š cat /etc/redhat-release CentOS Linux release 7.3.1611 (Core) æ­£å¸¸çš„ï¼š cat /etc/redhat-release CentOS Linux release 7.5.1804 (Core) å‘ç°æ˜¯linuxç‰ˆæœ¬æœ‰å·®å¼‚ï¼Œè¿›è¡Œæ›´æ–°åå¯ä»¥æ­£å¸¸ä½¿ç”¨ yum update -y å‚è€ƒé“¾æ¥ https://docs.docker.com/buildx/working-with-buildx/ https://zhuanlan.zhihu.com/p/227048978 https://github.com/docker/buildx/issues/80 https://github.com/bryant-rh/buildx-example ","date":"2021-01-24","objectID":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/:10:0","tags":["buildx","docker"],"title":"ä½¿ç”¨buildxæ„å»ºå¤šå¹³å°é•œåƒ","uri":"/shi-yong-buildxgou-jian-duo-ping-tai-jing-xiang/"},{"categories":["docker"],"content":"ä¸¤ä¸ªæœåŠ¡å™¨åœ°å€ï¼š 172.17.5.10 192.168.90.100 ä»172.17.5.10 telnet 192.168.90.100 æç¤ºnoroute to host 172.17.5.10æŠ“åŒ…ï¼Œå‘å‡ºå»äº†ä½†æ˜¯æ²¡æ”¶åˆ°å›åŒ… [root@vlnx005010 ~]# tcpdump -i eth0 -A port 80 and host 192.168.90.100 -vvv tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes 11:20:15.637884 IP (tos 0x10, ttl 64, id 37097, offset 0, flags [DF], proto TCP (6), length 60) localhost.50038 \u003e localhost.http: Flags [S], cksum 0xcc56 (incorrect -\u003e 0x5db9), seq 321553758, win 29200, options [mss 1460,sackOK,TS val 973542839 ecr 0,nop,wscale 8], length 0 E..\u003c..@.@...... ..Zd.v.P.*.^......r..V......... :........... 192.168.90.100æŠ“åŒ…ï¼Œæ¥å—åˆ°äº†åŒ…ï¼Œä½†æ˜¯æ²¡å›åŒ… [root@SFADMS dts]# tcpdump -A port 80 -vvv tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes 10:41:31.312762 IP (tos 0x10, ttl 59, id 33216, offset 0, flags [DF], proto TCP (6), length 60) 172.17.5.10.7598 \u003e SFADMS.localdomain.http: Flags [S], cksum 0x96df (correct), seq 1563107213, win 29200, options [mss 1460,sackOK,TS val 971218509 ecr 0,nop,wscale 8], length 0 E..\u003c..@.;...... ..Zd...P]+........r............ 9..M........ åˆ°è¿™é‡Œä¼°è®¡å’Œé˜²ç«å¢™è§„åˆ™æœ‰å…³ç³»ï¼Œçªç„¶æƒ³èµ·æ¥äº†æ˜¨å¤©ä¿®æ”¹è¿‡dockerç½‘æ®µï¼Œä¼°è®¡æ˜¯æ²¡æ›´æ–°ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œåï¼Œå¯ä»¥æ­£å¸¸é€šä¿¡ã€‚ æ•…éšœæ—¶æ²¡æœ‰çœ‹ç›¸å…³é”™è¯¯çš„ä¿¡æ¯ï¼Œç›´æ¥æ¸…ç©ºäº†ï¼Œä¸‹å›æœ‰æ—¶é—´æµ‹è¯•ä¸€ä¸‹è¡¥å……ä¸Šã€‚ iptables -F systemctl restart docker ","date":"2021-01-24","objectID":"/telnet-docker-zhuan-fa-de-duan-kou-no-route-to-host/:0:0","tags":["docker","é”™è¯¯æ€»ç»“"],"title":"telnet docker è½¬å‘çš„ç«¯å£no route to host","uri":"/telnet-docker-zhuan-fa-de-duan-kou-no-route-to-host/"},{"categories":["golang"],"content":"æ»‘åŠ¨çª—å£ç®—æ³•ç›¸æ¯”è¾ƒå›ºå®šçª—å£ç®—æ³•çš„æ”¹è¿›æ˜¯è§£å†³äº†å›ºå®šçª—å£åˆ‡æ¢æ—¶å¯èƒ½ä¼šäº§ç”Ÿä¸¤å€äºé˜ˆå€¼æµé‡è¯·æ±‚çš„ç¼ºç‚¹ã€‚ ç¤ºä¾‹ï¼š package main import ( \"log\" \"sync\" \"time\" ) type counterSlidingWindow struct { windowSize int64 //æ•´ä¸ªæ»‘åŠ¨çª—å£çš„å¤§å°ï¼Œå•ä½ç§’ splitNum int64 // åˆ‡åˆ†çª—å£çš„æ•°ç›®å¤§å°ï¼Œæ¯ä¸ªçª—å£å¯¹åº”ä¸€ä¸ªæ¡¶å­˜å‚¨æ•°æ®ã€‚ currentBucket int // å½“å‰çš„æ¡¶ limit int // æ»‘åŠ¨çª—å£å†…é™æµå¤§å° Bucket []int // å­˜æ”¾æ¯ä¸ªçª—å£å†…çš„è®¡æ•° startTime int64 // æ»‘åŠ¨çª—å£å¼€å§‹æ—¶é—´ } func NewSlidingWindow(windowSize int64, limit int, splitNum int64) *counterSlidingWindow { return \u0026counterSlidingWindow{ windowSize: windowSize, limit: limit, splitNum: splitNum, currentBucket: 0, Bucket: make([]int, splitNum), startTime: time.Now().Unix(), } } func (c *counterSlidingWindow) tryAcquire() bool { currentTime := time.Now().Unix() // è®¡ç®—è¯·æ±‚æ—¶é—´æ˜¯å¦å¤§äºå½“å‰æ»‘åŠ¨çª—å£çš„æœ€å¤§æ—¶é—´ // ç®—å‡ºå½“å‰æ—¶é—´å’Œå¼€å§‹æ—¶é—´å‡å»çª—å£å¤§å°çš„å€¼ï¼Œä½œç”¨ä¸ºè®¡ç®—è¶…å‡ºå½“å‰æ»‘åŠ¨çª—å£çš„æ—¶é—´ t := currentTime - c.windowSize - c.startTime // å¦‚æœå°äºæˆ–ç­‰äº0åˆ™ä»£è¡¨æœªè¶…å‡ºå½“å‰æ»‘åŠ¨çª—å£çš„æ—¶é—´ã€‚ if t \u003c 0 { t = 0 } // ç”¨té™¤ä»¥æ»‘åŠ¨çª—å£çš„ä»½æ•°ï¼Œè®¡ç®—å‡ºéœ€è¦æ»‘åŠ¨çš„æ•°é‡ã€‚ windowsNum := t / (c.windowSize / c.splitNum) c.slideWindow(windowsNum) count := 0 for i := 0; i \u003c int(c.splitNum); i++ { count += c.Bucket[i] } log.Printf(\"å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: %d\", count) if count \u003e c.limit { //log.Println(\"å¼€å§‹é™æµ\") return false } index := c.getCurrentBucket() log.Println(\"å½“å‰çš„bucket\", index) c.Bucket[index]++ return true } func (c *counterSlidingWindow) getCurrentBucket() int { currentTime := time.Now().Unix() t := int(currentTime / (c.windowSize / c.splitNum) % c.splitNum) return t } func (c *counterSlidingWindow) slideWindow(windowsNum int64) { var ( // æ»‘åŠ¨çª—å£é»˜è®¤è®¾ç½®ä¸º splitNum slideNum int64 = c.splitNum ) if windowsNum == 0 { return } // å¦‚æœwindowsNumå°äºsplitNumï¼Œåˆ™å°†slideNumè®¾ç½®ä¸ºwindowsNum // å¦‚æœwindowsNumå¤§äºsplitNumï¼Œå°±ä»£è¡¨éœ€è¦æ»‘åŠ¨çš„çª—å£å¤§äºä¸€è½®äº†ï¼Œæ‰€ä»¥ç›´æ¥æ¸…ç©ºå½“å‰æ‰€æœ‰æ»‘åŠ¨çª—å£ if windowsNum \u003c c.splitNum { slideNum = windowsNum } log.Println(\"å½“å‰è¦æ»‘åŠ¨çš„çª—å£æ•°\", slideNum) for i := 0; i \u003c int(slideNum); i++ { // æ ¹æ®splitNumå–ä½™ï¼Œè·å–å½“å‰çš„bucket c.currentBucket = (c.currentBucket +1) % int(c.splitNum) log.Printf(\"å½“å‰æ¸…ç©ºçš„ä½ç½®: %d, å½“å‰çš„å¤§å°: %d\",c.currentBucket, c.Bucket[c.currentBucket]) c.Bucket[c.currentBucket] = 0 } c.startTime = c.startTime + windowsNum * (c.windowSize / c.splitNum) } func main() { c := NewSlidingWindow(10, 5, 5) c.tryAcquire() wg := sync.WaitGroup{} wg.Add(1) go func() { defer func() { wg.Done() }() for i:=0; i\u003c= 100; i++ { for j:=0; j\u003c1; j++ { if c.tryAcquire() { } } //time.Sleep(time.Millisecond * 1429) time.Sleep(time.Second *6) } }() go func() { defer func() { wg.Done() }() for i:=0; i\u003c= 100; i++ { for j:=0; j\u003c1; j++ { if c.tryAcquire() { } } time.Sleep(time.Millisecond * 1429) //time.Sleep(time.Second *6) } }() wg.Wait() } è¾“å‡ºï¼š 2021/01/11 21:51:05 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 0 2021/01/11 21:51:05 å½“å‰çš„bucket 2 2021/01/11 21:51:05 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 1 2021/01/11 21:51:05 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 1 2021/01/11 21:51:05 å½“å‰çš„bucket 2 2021/01/11 21:51:05 å½“å‰çš„bucket 2 2021/01/11 21:51:06 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 3 2021/01/11 21:51:06 å½“å‰çš„bucket 3 2021/01/11 21:51:07 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 4 2021/01/11 21:51:07 å½“å‰çš„bucket 3 2021/01/11 21:51:09 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 5 2021/01/11 21:51:09 å½“å‰çš„bucket 4 2021/01/11 21:51:10 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:11 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:12 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:13 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:15 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:16 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:17 å½“å‰è¦æ»‘åŠ¨çš„çª—å£æ•° 1 2021/01/11 21:51:17 å½“å‰æ¸…ç©ºçš„ä½ç½®: 1, å½“å‰çš„å¤§å°: 0 2021/01/11 21:51:17 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:17 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 6 2021/01/11 21:51:19 å½“å‰è¦æ»‘åŠ¨çš„çª—å£æ•° 1 2021/01/11 21:51:19 å½“å‰æ¸…ç©ºçš„ä½ç½®: 2, å½“å‰çš„å¤§å°: 3 2021/01/11 21:51:19 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 3 2021/01/11 21:51:19 å½“å‰çš„bucket 4 2021/01/11 21:51:20 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 4 2021/01/11 21:51:20 å½“å‰çš„bucket 0 2021/01/11 21:51:22 å½“å‰è¦æ»‘åŠ¨çš„çª—å£æ•° 1 2021/01/11 21:51:22 å½“å‰æ¸…ç©ºçš„ä½ç½®: 3, å½“å‰çš„å¤§å°: 2 2021/01/11 21:51:22 å½“å‰æ»‘åŠ¨çª—å£æ€»æ•°ä¸º: 3 2021/01/11 21:51:22 å½“å‰çš„bucket 1 2021/01/11 21:51:23 å½“å‰è¦æ»‘åŠ¨çš„çª—å£æ•° 1 2021/01/11 21:51:23 å½“å‰æ¸…ç©ºçš„ä½ç½®: 4, å½“å‰çš„å¤§å°: 2 æ³¨æ„ï¼šè¿™åªæ˜¯æµ‹è¯•çš„ä¾‹å­ï¼Œè¿˜è¦è€ƒè™‘å¹¶å‘æ“ä½œä¸‹è€ƒè™‘åŠ é”æˆ–è€…ä½¿ç”¨atmoic ã€‚ å‚è€ƒèµ„æ–™ ä¸€æ–‡ææ‡‚é«˜é¢‘é¢è¯•é¢˜ä¹‹é™æµç®—æ³•ï¼Œä»ç®—æ³•åŸç†åˆ°å®ç°ï¼Œå†åˆ°å¯¹æ¯”åˆ†æ ","date":"2021-01-23","objectID":"/jian-dan-shi-xian-hua-dong-chuang-kou-ji-shu-qi-xian-liu/:0:0","tags":["golang","ç®—æ³•"],"title":"ç®€å•å®ç°æ»‘åŠ¨çª—å£è®¡æ•°å™¨é™æµ","uri":"/jian-dan-shi-xian-hua-dong-chuang-kou-ji-shu-qi-xian-liu/"},{"categories":["hugo"],"content":"hugoåˆä½“éªŒ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:0:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"å®‰è£…hugo ä¸‹è½½é“¾æ¥ æˆ‘è¿™é‡Œé€‰æ‹©çš„æœ€æ–°ç‰ˆæœ¬v0.80.0ï¼Œé€‰æ‹©æ“ä½œç³»ç»Ÿå¯¹åº”çš„ç‰ˆæœ¬å³å¯ã€‚ ä¸‹è½½åå°†hugo.exeåŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œæˆ‘æ˜¯ä¹ æƒ¯åˆ›å»ºä¸€ä¸ªbinç›®å½•ï¼Œå°†å¯æ‰§è¡Œæ–‡ä»¶éƒ½æ”¾åˆ°è¿™é‡Œã€‚ ps ä¸‹è½½çš„æ—¶å€™å‘ç°é“¾æ¥ç«Ÿç„¶æ‰“ä¸å¼€äº†ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ hostsè§£å†³ # github 199.232.96.133 avatars0.githubusercontent.com 199.232.96.133 avatars1.githubusercontent.com 199.232.96.133 avatars2.githubusercontent.com 199.232.96.133 avatars3.githubusercontent.com 199.232.96.133 avatars4.githubusercontent.com 199.232.96.133 avatars5.githubusercontent.com 199.232.96.133 avatars6.githubusercontent.com 199.232.96.133 avatars7.githubusercontent.com 199.232.96.133 avatars8.githubusercontent.com 199.232.96.133 user-images.githubusercontent.com ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:1:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"åˆ›å»ºä¸€ä¸ªhugoé¡¹ç›® $ hugo.exe new site jinnzy.github.io.source ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:2:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"å®‰è£…ä¸»é¢˜ è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•æˆ‘é‡‡ç”¨çš„ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥ç›´æ¥ä¿®æ”¹ã€‚ ç¬¬ä¸€ç§ï¼šä¸‹è½½æœ€æ–°çš„å‹ç¼©åŒ…æˆ–ç›´æ¥cloneåˆ°themesç›®å½• $ cd jinnzy.github.io.source $ git clone https://github.com/dillonzq/LoveIt.git themes/LoveIt ç¬¬äºŒç§ï¼šä½¿ç”¨å­æ¨¡å—æ¥å®‰è£… $ cd jinnzy.github.io.source $ git init $ git submodule add https://github.com/dillonzq/LoveIt.git themes/LoveIt ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:3:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"ä¿®æ”¹é…ç½® ä½ç½®ï¼š./config.toml å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸­3.1çš„ç¤ºä¾‹é…ç½®ï¼Œç”±äºå¤ªå¤§è¿™é‡Œå°±ä¸è´´å‡ºæ¥äº† åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘é¢å¤–ä¿®æ”¹äº†ä»¥ä¸‹å‡ ä¸ªé…ç½®ï¼Œå…¶ä½™çš„å°±æ˜¯ä¸€äº›ç½‘ç«™æ ‡é¢˜æè¿°ç­‰çš„å°±ä¸å¤šè¯´äº†ã€‚ # æ˜¯å¦ä½¿ç”¨ git ä¿¡æ¯ enableGitInfo = true [params] gitRepo = \"jinnzy.github.io.source\" [markup] # ç›®å½•è®¾ç½® [markup.tableOfContents] # ä»1ä¸ª#å¼€å§‹ç®—æ ‡é¢˜ï¼Œé»˜è®¤æ˜¯ä¸¤ä¸ª#å¼€å§‹ç®—æ ‡é¢˜ startLevel = 1 endLevel = 6 ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:4:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"ä¿®æ”¹æ–‡ç« é»˜è®¤çš„æ¨¡æ¿ ä½ç½®ï¼š./archetypes/default.md --- title: \"{{ replace .Name \"-\" \" \" | title }}\" date: {{ .Date }} draft: false toc: true tags: - \"\" categories: - \"\" --- åŠ å…¥äº†ç›®å½•æ ‡ç­¾å’Œåˆ†ç±»ç­‰ã€‚ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:5:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡ç«  $ hugo new posts/hugo-blog-1.md å¯åŠ¨è¿›è¡Œæµ‹è¯•ï¼Œä¼šæŠ¥é”™ $ hugo server -D Â·Â·Â· Error: Error building site: failed to render pages: render of \"page\" failed: execute of template failed: template: posts/single.html:92:124: executing \"content\" at \u003cpartial \"function/content.html\"\u003e: error calling partial: \"/Users/tc/Documents/workspace_2020/blog/themes/loveIt/layouts/partials/function/content.html:15:15\": execute of template failed: template: partials/function/content.html:15:15: executing \"partials/function/content.html\" at \u003cpartial \"function/checkbox.html\" $content\u003e: error calling partial: partial that returns a value needs a non-zero argument. -Dä¸åŠ ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºå‰é¢å·²ç»è®¾ç½® draft: false äº†ã€‚ è¿™é‡ŒæŠ¥é”™æ˜¯ä¸€ä¸ªbugï¼Œå·²ç»æœ‰äººprä½†æ˜¯å¹¶æœªåˆå¹¶è¿›æ¥ï¼Œæ‰€ä»¥è¦è‡ªå·±æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹ã€‚ ä¿®æ”¹æ–‡ä»¶ï¼šthemes/loveIt/layouts/partials/function/content.html ä¿®æ”¹åå¦‚ä¸‹ {{- $content := .Content -}} {{- if ne \"\" $content -}} {{- if .Ruby -}} {{- $content = partial \"function/ruby.html\" $content -}} {{- end -}} {{- if .Fraction -}} {{- $content = partial \"function/fraction.html\" $content -}} {{- end -}} {{- if .Fontawesome -}} {{- $content = partial \"function/fontawesome.html\" $content -}} {{- end -}} {{- $content = partial \"function/checkbox.html\" $content -}} {{- $content = partial \"function/escape.html\" $content -}} {{- end -}} {{- return $content -}} éšåå†æ¬¡å¯åŠ¨ï¼Œè¿›å…¥[http://localhost:1313](http://localhost:1313/) å°±å¯ä»¥çœ‹åˆ°åšå®¢é¦–é¡µäº†ã€‚ åˆ©ç”¨github pageséƒ¨ç½²blog å‰ç½®æ¡ä»¶ï¼šéœ€è¦å®‰è£…git ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:6:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"åˆ›å»ºgithubä»“åº“ ç™»å½•githubåˆ›å»ºåº“ æˆ‘è¿™é‡Œæ˜¯åˆ›å»ºäº†ä¸¤ä¸ªåº“ jinnzy.github.io.source é€‰æ‹©çš„æ˜¯ç§æœ‰åº“(Private)å­˜æ”¾hugoæºæ–‡ä»¶ï¼Œåˆ©ç”¨github actionsæ¥ç¼–è¯‘ç”Ÿæˆé™æ€æ–‡ä»¶æ¨é€åˆ°jinnzy.github.ioåº“ä¸­ jinnzy.github.io é€‰æ‹©çš„æ˜¯å…¬å…±åº“(Public)å­˜æ”¾hugoç¼–è¯‘åçš„é™æ€é¡µé¢ï¼Œä¸»è¦æ˜¯é€šè¿‡github pagesåŠŸèƒ½è®¿é—®è¿™äº›é™æ€æ–‡ä»¶ã€‚ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:7:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"é…ç½®github ssh key ç”Ÿæˆssk key $ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/root/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /root/.ssh/id_rsa. Your public key has been saved in /root/.ssh/id_rsa.pub. The key fingerprint is: 53:0e:0b:0f:c0:b8:d3:4f:e1:8a:a8:5d:8c:8f:98:cf jinzhy@vlnx107005.firstshare.cn The key's randomart image is: +--[ RSA 2048]----+ | o. | | . ... | | o .o.. . | | o . o+ = | | . = + S . | |. o + . . | |.+ + | |+.o . | | .E | +-----------------+ /root/.ssh/id_rsa ç§é’¥ /root/.ssh/id_rsa.pub å…¬é’¥ æ‰“å¼€jinnzy.github.io.source åº“æ·»åŠ Secrets ï¼Œåç§°ä¸ºACTIONS_DEPLOY_KEYï¼Œå°†/root/.ssh/id_rsaçš„å†…å®¹å¤åˆ¶è¿›å» æ‰“å¼€jinnzy.github.io åº“æ·»åŠ Deploy keys ï¼Œåç§°éšä¾¿éƒ½è¡Œï¼Œå°†/root/.ssh/id_rsa.pubçš„å†…å®¹å¤åˆ¶è¿›å»ã€‚ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:8:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"é…ç½®github actions æ‰“å¼€jinnzy.github.io.sourceï¼Œåˆ›å»ºActions å…¨éƒ¨å†…å®¹å¦‚ä¸‹ï¼š name: Deploy Hugo Site to Github Pages on Main Branch on: push: branches: - main jobs: build-deploy: runs-on: ubuntu-18.04 steps: - uses: actions/checkout@v2 - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: '0.80.0' extended: true # ä½¿ç”¨æ‰©å±•ç‰ˆ - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }} # è¿™é‡Œçš„ ACTIONS_DEPLOY_KEY åˆ™æ˜¯ä¸Šé¢è®¾ç½® Private Keyçš„å˜é‡å external_repository: jinnzy/jinnzy.github.io # Pages è¿œç¨‹ä»“åº“ publish_dir: ./public keep_files: false # remove existing files publish_branch: main # deploying branch commit_message: ${{ github.event.head_commit.message }} ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:9:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"ä¸Šä¼ hugoé¡¹ç›®ä¼ åˆ°github å½“å‰æ‰€åœ¨ç›®å½•ï¼š./jinzhy.github.io.source $ git init $ git commit -m \"first commit\" $ git branch -M main $ git remote add origin https://github.com/jinnzy/jinzhy.github.io.source.git $ git pull # å…ˆæŠŠä¹‹å‰æäº¤çš„çš„å†…å®¹æ‹‰å–ä¸‹æ¥ $ git push -u origin main è¿›å…¥Actions å¯ä»¥çœ‹åˆ°ä¸Šä¼ æˆåŠŸäº† æ‰“å¼€jinzhy.github.io é¡¹ç›® ä¸‹æ‹‰æ‰¾åˆ°GitHub Pages å¯ä»¥çœ‹åˆ°å‘å¸ƒåœ°å€ï¼Œè¿™æ—¶è®¿é—®https://jinnzy.github.io å°±å¯ä»¥çœ‹åˆ°åšå®¢äº†ã€‚ ConsoleæŠ¥é”™æ‰¾ä¸åˆ°/site.webmanifest å¼•ç”¨è‡ªlewky.cnåšå®¢ä¸­çš„å†…å®¹ã€‚ è¯¥æ–‡ä»¶å’ŒProgressive web applications (PWA)æœ‰å…³ï¼Œé€šè¿‡æ·»åŠ PWAåˆ°Hugoç«™ç‚¹ï¼Œå¯ä»¥å®ç°ç¦»çº¿è®¿é—®çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´æ–­ç½‘çŠ¶æ€ä¸‹ä¾ç„¶å¯ä»¥è®¿é—®åˆ°ä½ ä¹‹å‰è®¿é—®è¿‡çš„ç½‘é¡µï¼Œæ¢è¨€ä¹‹å°±æ˜¯é€šè¿‡PWAæ¥å°†è®¿é—®è¿‡çš„ç½‘é¡µèµ„æºç¼“å­˜åˆ°äº†æœ¬åœ°ï¼Œæ‰€ä»¥æ–­ç½‘ä¸‹ä»ç„¶å¯ä»¥ç»§ç»­è®¿é—®ç½‘ç«™ã€‚å½“ç„¶ï¼Œæ¢å¤ç½‘ç»œæ—¶ä¼šè‡ªåŠ¨æ›´æ–°æœ€æ–°çš„é¡µé¢èµ„æºã€‚ ä½†æ˜¯ç›®å‰è¯¥åŠŸèƒ½è¿˜ä¸å¤Ÿå®Œå–„ï¼Œå¯èƒ½å­˜åœ¨ç€å®‰å…¨æ€§çš„é—®é¢˜ï¼Œå¹¶ä¸”å®ç°è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒç¹æ‚ï¼Œæœ€ç»ˆè¿˜æ˜¯å†³å®šæŠŠè¿™ä¸ªå¼•ç”¨ç»™å»æ‰ï¼Œåšæ³•å¦‚ä¸‹ï¼š æŠŠåšå®¢ä¸»é¢˜ç›®å½•ä¸‹çš„\\themes\\LoveIt\\layouts\\partials\\head\\link.htmlæ‹·è´åˆ°æ ¹ç›®å½•ä¸‹çš„\\layouts\\partials\\head\\link.html æ‰“å¼€æ‹·è´åçš„link.htmlï¼ŒæŠŠ\u003clink rel=\"manifest\" href=\"/site.webmanifest\"\u003eåˆ æ‰æˆ–è€…æ³¨é‡Šæ‰ï¼š {{- /* \u003clink rel=\"manifest\" href=\"/site.webmanifest\"\u003e */ -}} æ·»åŠ å‹é“¾ æ³¨æ„ï¼šå‚è€ƒäº†Referenceä¸­çš„å‡ ç¯‡æ–‡ç« æ·»åŠ å‹é“¾ï¼Œå‘ç°cssæ ·å¼æ€»æ˜¯ä¸ç”Ÿæ•ˆï¼ŒæŸ¥äº†ä¸€ä¸‹åˆæ‰åœ¨è¿™ä¸ªprä¸­å‘ç°loveit ä¸»é¢˜æŸäº›åŠŸèƒ½éœ€è¦æŠŠscss è½¬æ¢ä¸ºcss æ‰€ä»¥è¦é€‰æ‹©æ‰©å±•ç‰ˆä¸‹è½½ï¼Œæ‰€ä»¥åˆé‡æ–°ä¸‹è½½äº†hugo_extended_0.80.0_Windows-64bit è¿™ä¸ªç‰ˆæœ¬ğŸ˜­ã€‚ ä¸»è¦ä½¿ç”¨kkkgo/hugo-friendlinksé¡¹ç›®ä¸­çš„ä»£ç ã€‚ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:10:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"æ·»åŠ å‹é“¾æ ·å¼ ä½ç½®ï¼šjinnzh.github.io.source/assets/css/_custom.scss // friendslink .myfriends { text-align: center; background-color: #fff; opacity: 0.9; } .myfriends a { color: black; } .myfriends p { display: none; } .friendurl { text-decoration: none !important; color: black; } .myfriend { width: 56px !important; height: 56px !important; border-radius: 50%; border: 1px solid #ddd; padding: 2px; box-shadow: 1px 1px 1px rgba(0,0,0, .15); margin-top: -12px !important; margin-left: 10px !important; background-color: #fff; } .frienddiv { position: relative; left: 0; right: 0; width: 100%; height: 70px; line-height: 1.38; margin-top: -5px; margin-bottom: -5px; border-radius: 5px; background: rgba(255, 255, 255, .2); box-shadow: 4px 4px 2px 1px rgba(0, 0, 255, .2); overflow: hidden; } .frienddiv:hover { background: rgba(87, 142, 224, 0.15); } .frienddiv:hover .frienddivleft img { transition: .9s!important; -webkit-transition: .9s!important; -moz-transition: .9s!important; -o-transition: .9s!important; -ms-transition: .9s!important; transform: rotate(360deg)!important; -webkit-transform: rotate(360deg)!important; -moz-transform: rotate(360deg)!important; -o-transform: rotate(360deg)!important; -ms-transform: rotate(360deg)!important; } .frienddivleft { width: 92px; float: left; } .frienddivleft { margin-top: 15px; margin-right: 2px; } .frienddivright { margin-top: 15px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; } ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:11:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"åˆ›å»ºshortcodeså‹é“¾æ–‡ä»¶ ä½ç½®ï¼šjinnzh.github.io.source/layouts/shortcodes/friend.html {{ if .IsNamedParams }} \u003cp\u003e\u003ca target=\"_blank\" href={{ .Get \"url\" }} title={{ .Get \"name\" }} class=\"friendurl\"\u003e \u003cdiv class=\"frienddiv\"\u003e \u003cdiv class=\"frienddivleft\"\u003e \u003cimg class=\"myfriend\" src={{ .Get \"logo\" }} /\u003e \u003c/div\u003e \u003cdiv class=\"frienddivright\"\u003e {{ .Get \"name\" }}\u003cbr /\u003e{{ .Get \"word\" }} \u003c/div\u003e \u003c/div\u003e \u003c/a\u003e \u003c/p\u003e {{ end }} ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:12:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"åˆ›å»ºfriend mdæ–‡ä»¶ ä½ç½®ï¼šjinnzh.github.io.source/content/friends.md å‹é“¾ --- hiddenFromSearch: true --- # å‹é“¾ {{\u003c friend name=\"Dillon\" url=\"https://github.com/dillonzq/\" logo=\"https://avatars0.githubusercontent.com/u/30786232?s=460\u0026u=5fc878f67c869ce6628cf65121b8d73e1733f941\u0026v=4\" word=\"LoveItä¸»é¢˜ä½œè€…\" \u003e}} è¿™é‡Œçš„friend æ˜¯å¼•ç”¨ä¸Šä¸ªæ­¥éª¤ä¸­åˆ›å»ºçš„friend shortcodes ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:13:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["hugo"],"content":"èœå•ä¸­æ·»åŠ å‹é“¾ ä½ç½®ï¼šjinnzh.github.io.source/config.toml [menu] [[menu.main]] identifier = \"friends\" pre = \"\" post = \"\" name = \"å‹é“¾\" url = \"/friends/\" title = \"\" weight = 4 weightæŒ‰èœå•é¡ºåºå¾€ä¸‹æ’å³å¯ã€‚ æœ€ç»ˆæ•ˆæœ æ·»åŠ ä¸è’œå­ï¼Œå±•ç¤ºç½‘ç«™è®¿é—®äººæ•° è¿™é‡Œçš„æ“ä½œéƒ½åœ¨jinnzy.github.io.source é¡¹ç›®å†…æ“ä½œ å¤åˆ¶baseof.html æ–‡ä»¶ $ mkdir -p ./layouts/_default # æ²¡æœ‰ç›®å½•åˆ™åˆ›å»º $ cp themes/LoveIt/layouts/_default/baseof.html layouts/_default/baseof.html æ‰“å¼€åˆšå¤åˆ¶çš„layouts/_default/baseof.html ï¼Œæ·»åŠ \u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e ï¼Œå¼•å…¥ä¸è’œå­jsæ–‡ä»¶ {{- partial \"init.html\" . -}} \u003c!DOCTYPE html\u003e \u003chtml lang=\"{{ .Site.LanguageCode }}\"\u003e \u003chead\u003e \u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e \u003cmeta charset=\"utf-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e \u003cmeta name=\"robots\" content=\"noodp\" /\u003e \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge, chrome=1\"\u003e \u003ctitle\u003e {{- block \"title\" . }}{{ .Site.Title }}{{ end -}} \u003c/title\u003e {{- partial \"head/meta.html\" . -}} {{- partial \"head/link.html\" . -}} {{- partial \"head/seo.html\" . -}} \u003c/head\u003e ... æ‰“å¼€config.toml ï¼Œä¿®æ”¹ä»¥ä¸‹é…ç½® [params.footer] enable = true # è‡ªå®šä¹‰å†…å®¹ (æ”¯æŒ HTML æ ¼å¼) custom = '\u003cspan id=\"busuanzi_container_site_pv\"\u003eæœ¬ç«™æ€»è®¿é—®é‡\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003eæ¬¡\u003c/span\u003e â€¢ \u003cspan id=\"busuanzi_container_site_uv\"\u003eè®¿å®¢æ•°\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003eäººæ¬¡\u003c/span\u003e' æœ€ç»ˆæ•ˆæœï¼š ç”±äºæ˜¯æœ¬åœ°æµ‹è¯•ï¼ŒåŸŸåéƒ½æ˜¯localhostæ‰€ä»¥æ˜¾ç¤ºè¿™ä¹ˆå¤§çš„é‡æ˜¯æ­£å¸¸çš„ï¼Œå‘å¸ƒåä½¿ç”¨çœŸå®åŸŸåæ•°é‡å°±ä¼šæ˜¾ç¤ºæ­£å¸¸ ä½¿ç”¨valineä½œä¸ºè¯„è®ºç³»ç»Ÿ ç™»å½•æˆ–æ³¨å†Œleancloudï¼Œç‚¹å‡»å·¦ä¸Šè§’åˆ›å»ºåº”ç”¨ã€‚ åˆ›å»ºå¥½ä¹‹åï¼Œè¿›å…¥åº”ç”¨ï¼Œé€‰æ‹©è®¾ç½® \u003eåº”ç”¨Keysï¼Œè·å–AppID å’ŒApp Key ã€‚ æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„config.tomlï¼Œå¡«å…¥ä¸Šä¸ªæ­¥éª¤è·å–çš„AppID å’ŒApp Keyã€‚ [params.page.comment] enable = true [params.page.comment.valine] enable = true appId = \"xxxxx\" appKey = \"xxxxx\" è¿è¡Œé¡¹ç›®è¿›è¡Œæµ‹è¯•ï¼Œè®¾ç½®å˜é‡ä¸ºproduction ç¯å¢ƒï¼Œé»˜è®¤æ˜¯dev ä¸æ˜¾ç¤ºè¯„è®ºç­‰ç³»ç»Ÿã€‚ $ hugo server --environment production è¿›å…¥æ–‡ç« ï¼Œçœ‹æœ€åº•éƒ¨å·²ç»æœ‰è¯„è®ºå‡ºç°äº†ã€‚ ä½¿ç”¨è‡ªå®šä¹‰åŸŸå å‚è€ƒèµ„æ–™ https://lewky.cn/tags/hugo/ https://hugoloveit.com/zh-cn/categories/ kkkgo/hugo-friendlinkså‹é“¾ loveitè‡ªå®šä¹‰æ ·å¼ ä¸è’œå­ https://valine.js.org/quickstart.html æ¨é€ç™¾åº¦ç«™é•¿ ","date":"2021-01-23","objectID":"/shi-yong-hugolai-da-jian-ge-ren-blog/:14:0","tags":["hugo"],"title":"ä½¿ç”¨hugoæ¥æ­å»ºä¸ªäººblog","uri":"/shi-yong-hugolai-da-jian-ge-ren-blog/"},{"categories":["kubernetes"],"content":"ç¯å¢ƒä¿¡æ¯ å½“å‰ç‰ˆæœ¬ï¼šv1.17.5 ç›®æ ‡ç‰ˆæœ¬ï¼š1.18.15 å‡çº§æ–¹å¼ï¼škubeadm æ¨èå‡çº§çš„ç‰ˆæœ¬ä¸ºå½“å‰ç‰ˆæœ¬+1å¦‚1.16 å‡çº§åˆ°1.17 ï¼Œ1.17 å‡çº§åˆ°1.18 æŸ¥çœ‹å½“å‰yum æºé‡Œæ˜¯å¦æœ‰æ¨¡æ¿ç‰ˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰çš„è¯éœ€è¦æ›´æ–°yum æºã€‚ yum list --showduplicates kubeadm --disableexcludes=kubernetes Â·Â·Â· kubeadm.x86_64 1.18.13-0 kubernetes kubeadm.x86_64 1.18.14-0 kubernetes kubeadm.x86_64 1.18.15-0 kubernetes kubeadm.x86_64 1.19.0-0 kubernetes kubeadm.x86_64 1.19.1-0 kubernetes kubeadm.x86_64 1.19.2-0 kubernetes Â·Â·Â· å‡çº§masterèŠ‚ç‚¹ ","date":"2021-01-23","objectID":"/k8s-1-17-sheng-ji-dao-1-18/:0:0","tags":["kubernetes","kuberneteså‡çº§"],"title":"k8s 1.17 å‡çº§åˆ° 1.18","uri":"/k8s-1-17-sheng-ji-dao-1-18/"},{"categories":["kubernetes"],"content":"å‡†å¤‡å‡çº§æ‰€éœ€é•œåƒ æŸ¥çœ‹æ‰€éœ€é•œåƒï¼Œå°†è¿™äº›é•œåƒæ‹‰å–ä¸‹æ¥ä¼ åˆ°ç§æœ‰ä»“åº“é‡Œï¼Œå¯ä½¿ç”¨kubeadm config images list æŸ¥çœ‹æ‰€éœ€é•œåƒç‰ˆæœ¬(ä¼šåˆ—å‡ºå½“å‰kubeadmç‰ˆæœ¬æ‰€éœ€é•œåƒï¼Œå¦‚æœä¸ç¡®å®šéœ€è¦æ‹‰å–å“ªäº›é•œåƒï¼Œå¯ä»¥å‡çº§åˆ°å¯¹åº”ç‰ˆæœ¬çš„kubeadmè¿è¡ŒæŸ¥çœ‹æ‰€éœ€é•œåƒ)ã€‚ k8s.gcr.io/kube-apiserver:v1.18.15 k8s.gcr.io/kube-controller-manager:v1.18.15 k8s.gcr.io/kube-scheduler:v1.18.15 k8s.gcr.io/kube-proxy:v1.18.15 k8s.gcr.io/pause:3.2 k8s.gcr.io/etcd:3.4.3-0 k8s.gcr.io/coredns:1.6.7 æˆ‘ç›®å‰æ˜¯ä»registry.cn-hangzhou.aliyuncs.com/google_containers è¿™ä¸ªä»“åº“æ‹‰å–é•œåƒã€‚ pullReg=registry.cn-hangzhou.aliyuncs.com/google_containers pushReg=reg.xxx.cn/k8s.gcr.io for i in $(echo -n 'k8s.gcr.io/kube-apiserver:v1.18.15 k8s.gcr.io/kube-controller-manager:v1.18.15 k8s.gcr.io/kube-scheduler:v1.18.15 k8s.gcr.io/kube-proxy:v1.18.15 k8s.gcr.io/pause:3.2 k8s.gcr.io/coredns:1.6.7');do app=$(echo $i|awk -F 'k8s.gcr.io/' '{print $2}') \u0026\u0026 \\ docker pull ${pullReg}/${app} \u0026\u0026 \\ docker tag ${pullReg}/${app} ${pushReg}/${app} \u0026\u0026 \\ docker push ${pushReg}/${app}; done ","date":"2021-01-23","objectID":"/k8s-1-17-sheng-ji-dao-1-18/:1:0","tags":["kubernetes","kuberneteså‡çº§"],"title":"k8s 1.17 å‡çº§åˆ° 1.18","uri":"/k8s-1-17-sheng-ji-dao-1-18/"},{"categories":["kubernetes"],"content":"å¼€å§‹å‡çº§masterèŠ‚ç‚¹ é¦–å…ˆå‡çº§kubeadm yum -y install kubeadm-1.18.15-0 kubectl-1.18.15 æŸ¥çœ‹å‡çº§è®¡åˆ’ [root@vlnx107024 ~]# kubeadm upgrade plan Â·Â·Â· External components that should be upgraded manually before you upgrade the control plane with 'kubeadm upgrade apply': COMPONENT CURRENT AVAILABLE Etcd 3.4.9 3.4.3-0 Components that must be upgraded manually after you have upgraded the control plane with 'kubeadm upgrade apply': COMPONENT CURRENT AVAILABLE Kubelet 5 x v1.17.7 v1.18.15 Upgrade to the latest version in the v1.17 series: COMPONENT CURRENT AVAILABLE API Server v1.17.7 v1.18.15 Controller Manager v1.17.7 v1.18.15 Scheduler v1.17.7 v1.18.15 Kube Proxy v1.17.7 v1.18.15 CoreDNS 1.6.5 1.6.7 You can now apply the upgrade by executing the following command: kubeadm upgrade apply v1.18.15 å› ä¸ºè¿™ä¸ªk8sé›†ç¾¤æ˜¯ä½¿ç”¨é›†ç¾¤å¤–çš„etcd æ–¹å¼ï¼Œæ‰€ä»¥ç‰ˆæœ¬æ¯”è¾ƒæ–°ï¼Œå¦‚æœç‰ˆæœ¬ä½äºAVAILABLE çš„ç‰ˆæœ¬ï¼Œéœ€è¦å…ˆå‡çº§etcd å¼€å§‹å‡çº§ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼š kubeadm upgrade apply -y 1.18.15 --config=/root/kubeadm-config.yml --ignore-preflight-errors=all --force kubeadm upgrade apply å‚æ•°ï¼š --allow-experimental-upgrades : æ˜¾ç¤ºä¸ç¨³å®šç‰ˆæœ¬ï¼Œå…è®¸å‡çº§åˆ°alpha/betaæˆ–rcç‰ˆæœ¬ã€‚ --certificate-renewal : é»˜è®¤ä¸ºtrueï¼Œæ‰§è¡Œå‡çº§æœŸé—´æ›´æ–°è¯ä¹¦ --config : kubeadmé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰æ›´æ–°é…ç½®æ–‡ä»¶å¯ä»¥ä¸æ·»åŠ  --force : å¼ºåˆ¶å‡çº§ï¼Œéäº¤äº’æ¨¡å¼ --ignore-preflight-errors : ä¸ºall æ—¶å¿½ç•¥æ£€æŸ¥ä¸­çš„æ‰€æœ‰é”™è¯¯ --print-config : æ˜¯å¦æ‰“å°å‡çº§ä¸­ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ -y, --yes : éäº¤äº’æ¨¡å¼ã€‚ æŸ¥çœ‹æ›´æ–°èŠ‚ç‚¹çš„apiserver controler manager kube-schdule çŠ¶æ€åŠç‰ˆæœ¬æ˜¯å¦æ­£å¸¸ kubectl -n kube-system get po æ›´æ–°æˆåŠŸåé‡å¯kubelet systemctl restart kubelet æŸ¥çœ‹é›†ç¾¤å†…å½“å‰èŠ‚ç‚¹çš„ç‰ˆæœ¬ï¼Œä¸º1,18,15 å°±æ˜¯æ­£å¸¸äº† kubectl get nodes éšåä¾æ¬¡æ›´æ–°å¦å¤–ä¸¤ä¸ªmasterèŠ‚ç‚¹ kubeadm upgrade apply -y 1.18.15 --ignore-preflight-errors=all --force å‡çº§nodeèŠ‚ç‚¹ nodeèŠ‚ç‚¹å‡çº§æ“ä½œå°±æ›´ç®€å•äº† é¦–å…ˆåŒæ ·æ˜¯å®‰è£…åŒ… yum -y install kubeadm-1.18.15-0 kubectl-1.18.15 æœ€å¥½æ˜¯æ¸…ç©ºå½“å‰èŠ‚ç‚¹ï¼Œä¸è¿‡ç”±äºæˆ‘æ˜¯å‡çº§æµ‹è¯•ç¯å¢ƒå°±çœç•¥è¿™ä¸€æ­¥ï¼Œå‡çº§å®ŒèŠ‚ç‚¹ç”±äºç»“æ„ä½“æœ‰å˜åŒ–ï¼Œhashå€¼å˜æ›´ä¼šé‡å¯å½“å‰èŠ‚ç‚¹æ‰€æœ‰çš„podè¿›è¡Œæ›´æ–°ã€‚ kubectl drain --delete-local-data --force --ignore-daemonsets --grace-period=0 ${currentNodeName} å¼€å§‹æ›´æ–° kubeadm upgrade node é‡å¯kubelet systemctl restart kubelet æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€ kubectl get nodes æ²¡é—®é¢˜åé‡å¤æ­¤æ­¥éª¤ï¼Œä¾æ¬¡å‡çº§å‰©ä½™èŠ‚ç‚¹å³å¯ã€‚ å‚è€ƒèµ„æ–™ https://v1-18.docs.kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/ https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/kubeadm-upgrade/ ","date":"2021-01-23","objectID":"/k8s-1-17-sheng-ji-dao-1-18/:2:0","tags":["kubernetes","kuberneteså‡çº§"],"title":"k8s 1.17 å‡çº§åˆ° 1.18","uri":"/k8s-1-17-sheng-ji-dao-1-18/"}]